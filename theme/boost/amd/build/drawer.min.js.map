{"version":3,"sources":["../src/drawer.js"],"names":["backdropPromise","pageWrapper","document","querySelector","getBackdrop","Templates","render","then","html","ModalBackdrop","fail","Notification","exception","closeNav","navRegion","closeBackdrop","small","body","clientWidth","backdrop","hide","style","overflow","showNav","setZIndex","show","getRoot","addEventListener","region","getAttribute","dispatchEvent","CustomEvent","bubbles","detail","toggle","toggleButton","closeButton","e"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Toggling the visibility of the secondary navigation on mobile.\n *\n * @package    theme_boost\n * @copyright  2021 Bas Brands\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport {classUtil} from 'core/utils';\nimport ModalBackdrop from 'core/modal_backdrop';\nimport Templates from 'core/templates';\n\nlet backdropPromise = 0;\n\nconst pageWrapper = document.querySelector('#page-wrapper');\n\nconst getBackdrop = () => {\n    if (!backdropPromise) {\n        backdropPromise = Templates.render('core/modal_backdrop', {})\n            .then(function(html) {\n                return new ModalBackdrop(html);\n            })\n            .fail(Notification.exception);\n    }\n    return backdropPromise;\n};\n\nconst closeNav = (navRegion, closeBackdrop = true) => {\n    const small = document.body.clientWidth < 768;\n\n    classUtil('remove', navRegion, 'show');\n\n    if (small && closeBackdrop) {\n        getBackdrop().then(backdrop => {\n            backdrop.hide();\n            pageWrapper.style.overflow = 'auto';\n        });\n    }\n};\n\nconst showNav = (navRegion) => {\n    const small = document.body.clientWidth < 768;\n\n    classUtil('add', navRegion, 'show');\n\n    if (small) {\n        getBackdrop().then(backdrop => {\n            backdrop.setZIndex(1020);\n            backdrop.show();\n            pageWrapper.style.overflow = 'hidden';\n            backdrop.getRoot()[0].addEventListener('click', () => {\n                closeNav(navRegion);\n            });\n        });\n    }\n\n    const region = navRegion.getAttribute('data-region');\n    if (region) {\n        navRegion.dispatchEvent(new CustomEvent('show-boost-drawer', { bubbles: true, detail: region }));\n    }\n};\n\nexport const region = (region, toggle) => {\n    const navRegion = document.querySelector(region);\n    const toggleButton = document.querySelector(toggle);\n\n    if (!navRegion) {\n        return '';\n    }\n\n    const closeButton = navRegion.querySelector('[data-action=\"closedrawer\"]');\n\n    toggleButton.addEventListener('click', () => {\n        if (classUtil('has', navRegion, 'show')) {\n            closeNav(navRegion);\n        } else {\n            showNav(navRegion);\n        }\n    });\n\n    if (closeButton) {\n        closeButton.addEventListener('click', () => {\n            closeNav(navRegion);\n        });\n    }\n\n    // Close drawer when another drawer opens.\n    document.addEventListener('show-boost-drawer', e => {\n        const region = navRegion.getAttribute('data-region');\n        if (region !== e.detail) {\n            closeNav(navRegion, false);\n        }\n    });\n\n};\n"],"file":"drawer.min.js"}